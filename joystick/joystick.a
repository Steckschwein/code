*= $1000
jmp main 
!src <defs.h.a>
!src <bios.h.a>
!src <via.h.a>
!src <t99xx.lib.a>
!src <joystick.h.a>

main 
	jsr	init_via
    
    lda a_vreg
-   bit a_vreg
    bpl -	
   	jsr vdp_mode_gfx1_blank
    
-   bit a_vreg
    bpl -	
    stz crs_x
    stz crs_y

	lda	#PORT_SEL_1			;port 1
	sta	via1porta
	+PrintString msg_j1
	lda	via1porta
	and	#%00111111
	jsr	hexout

	lda	#PORT_SEL_2			;port 2
	sta	via1porta
    +PrintString msg_j2
	lda	via1porta
	and	#%00111111
	jsr	hexout
	bra -

init_via:	
	;via port a
	lda #$00
	sta via1ier             ; disable VIA1 T1 interrupts
	lda #%00000000 			; set latch
	sta via1acr
	lda #%11001100 			; set level
	sta via1pcr
	lda #%11000000 			; set PA6,7 to output (port select), PA1-6 to input (directions)
	sta via1ddra
	rts
	
msg_j1:
	!text "j1:",0
msg_j2:
	!text " j2:",0
