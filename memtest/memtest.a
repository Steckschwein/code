*=$1000
!src "../bios/defs.h.a"
!src "../bios/bios.h.a"

main

      ; Check zeropage
check_zp      
      ; Start at $ff
      ldy #$ff
      ; Start with pattern $03 : $ff
-     ldx #$03

--    lda pattern,x
      sta $00,y
 
      cmp $00,y
      bne zp_kaputt

      dex
      bne --

      dey
      bne -

      lda #'A'
      jsr lcdprint
      jmp check_mem 

      ; Broken
zp_kaputt
      txa
      jsr lcdclear
      jsr lcdhex
-     jmp -


check_mem
      ldy #$00
-     ldx #$03
--    lda pattern,x
a     sta $2000,y   ; Start at $0200. skip stack for now      
b     cmp $2000,y
      bne memcheck_end

      iny
      bne --

      inc a+2
      inc b+2
      bne -

memcheck_end
      jsr lcdclear

      lda #'$'
      jsr lcdprint
      lda a+2
      jsr lcdhex
      lda a+1
      jsr lcdhex
 
-     jmp -


pattern  !byte $aa,$55,$00,$ff