;
;	gfx multi color mode - 64x48 blocks with 4x4px per block, 15 colors + transparent
;
!src <defs.h.a>
!source <t9929.h.a>

!macro fill i{
	ldy #0
--	ldx	#i*32
-	+vnops
	stx a_vram
	inx
	cpx	#(i*32)+32
	bne	-
	iny
	cpy #4
	bne	--
}

*=$1000
	jsr	vdp_display_off			;display off
	jsr vdp_mode_sprites_off	;sprites off

;	0,0 - 
;	1,0 - 0 and 3 <<1 = 0

	lda	#<ADDRESS_GFX_MC_SCREEN
	ldy	#.WRITE_ADDRESS+ >ADDRESS_GFX_MC_SCREEN
	+vdp_sreg
	+fill 0
	+fill 1
	+fill 2
	+fill 3
	+fill 4
	+fill 5
	+fill 6	
	
	+SetVector .pattern, addr
	lda	#<ADDRESS_GFX_MC_PATTERN
	ldy	#.WRITE_ADDRESS+ >ADDRESS_GFX_MC_PATTERN
	ldx #1536/256
	jsr vdp_memcpy
	
	jsr vdp_mode_gfx_mc			;enable gfx3 mode

-	jmp	-

	lda	#<ADDRESS_GFX_MC_PATTERN
	ldy	#.WRITE_ADDRESS+ >ADDRESS_GFX_MC_PATTERN
	+vdp_sreg
	lda #Cyan<<4|Dark_Green
	sta a_vram
	+vnops
	sta a_vram


!src <t99xx.lib.a>

.pattern
;!bin "test/MODE3.TIAP"
!bin "test/PM112012.TIAP"