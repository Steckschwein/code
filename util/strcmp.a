 	*=$1000

	jmp main

dirptr=$0

dir_entry_size=11

test_input=input_10

test_dir_tab
	!word dir_1
	!word dir_2
	!word dir_3
	!word dir_4
	!word dir_5
	!word dir_6
	!word dir_7
test_dir_tab_e

test_input_tab
	!word input_1
	!word input_2
	!word input_3
	!word input_4
	!word input_5
	!word input_6
	

main
	ldx #0
l1:
	lda test_dir_tab,x
	sta $0
	lda test_dir_tab+1,x
	sta $1
	phx
	jsr match	; check <name>.<ext> against 11 byte dir entry <name> <ext>
	plx	
		
	inx
	inx
	cpx	#test_dir_tab_e-test_dir_tab
	bne	l1
	
	rts

match:
	ldx #0
	ldy #0	
match_0
	lda test_input,x
	beq m_found		;end of input, found
	cmp #'*'
	beq m_n
	cmp #'?'
	beq m_1			; ? - skip compare, matches anything - note: multiple ? will end up in consuming the input string char by char until ' '
	cmp #'.'		;
	bne m_r

	inx
	lda #' '		; '.' found in input, seek to dir entry extension offset
match_ext	
	cmp (dirptr),y
	bne match_0
match_ext_1
	iny
	cpy #dir_entry_size
	beq	m_not_found
	bra	match_ext
	
m_r	cmp	#'a'		; regular char, match uppercase
	bcc m_r_match
	cmp #'z'
	bcs m_r_match
	and #$df		; uppercase
m_r_match	
	cmp (dirptr),y	; regular char, compare
	bne m_not_found
m_1
	inx
	iny
	cpy #dir_entry_size
	bne match_0
	
	lda test_input,x	;input chars left?
	beq m_found
	bra m_not_found
	
m_n	inx
	cmp test_input,x	; skip read multiple '*'
	beq m_n
	
	lda #' '
m_n1
	cmp (dirptr),y		; until ' '
	beq match_ext_1		; then go on with skip until extension above
m_n2
	iny		
	cpy #dir_entry_size
	bne m_n1	; end of dir entry? found...
m_found
	sec
 	rts
m_not_found
	clc
 	rts

dir_1	     !text "FILE00  TXT"
dir_2	     !text "LL      BIN"
dir_3	     !text "LS      BIN"
dir_4	     !text "LOADER  BIN"
dir_5	     !text "FILE04  TXT"
dir_6	     !text "TEST    TXT"
dir_7	     !text "PROGS      "

input_1 	!text "ls.bin",0
input_2 	!text "l*.bin",0
input_3 	!text "l?.bin",0
input_4 	!text "l**.bin",0
input_5 	!text "l??.bin",0
input_6 	!text "l?????.bin",0
input_7 	!text "Ls.bin",0
input_8 	!text ".",0
input_9 	!text "..",0
input_10 	!text "test.txtfoobar",0
input_11 	!text "test.txt",0
input_12 	!text "progs",0