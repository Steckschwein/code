*=$1000

jmp foo
!src "../bios/defs.h.a"
!src "../bios/bios.h.a"
!src "../vdp/t9929.h.a"


txtbuf=$0300
foo
	jsr lcdclear

	

	stz chn_in
	; lda #dev_lcd
	; sta chn_out
  	stz chn_out


 
; TODO: rausfinden warum hier nur datenm√ºll kommt
; DONE: attiny flop, atmega top
	
; -	
; 	jsr chrin
; 	beq -
;  	cmp #$ff
;  	beq - 

; 	jsr vdp_chrout

;  	jmp -

main

  	; stz chn_out
	ldx #$00
	stx crs_x

	stx txtbuf

	+PrintString text1

	; ldx #$00
	; ldy #$02
	; jsr lcdxy

	
	; ldx #$00

-	jsr chrin
	
	cmp #$0c
	beq +

	cmp #$08 ; Backspace
	bne ++
	dec crs_x
	dex
	stz txtbuf,x
	bra -
++	pha
	jsr chrout
	pla



	cmp #$0d ; return gedrueckt?
	beq out

	sta txtbuf,x
	inx
	stz txtbuf,x
	cpx #$0f
	beq out


	jmp -
+	
	;jsr lcdclear
	jmp -

out 
	lda txtbuf
	beq +
	jsr crlf
	;jsr lcdclear
	+PrintString  text2
	+PrintString  txtbuf
	jsr crlf

; --	jsr chrin
; 	cmp #$0d
; 	bne --
	jsr crlf
	jmp main
+
	jsr crlf
	+PrintString name
	jsr crlf
	jmp main

reset
	jmp ($fffc)

text1	!text "Wie heisst du? ", $00
text2	!text "Hallo, ", $00
name	!text "Bitte gib deinen Namen ein.", $00

!src "../vdp/t99xx.lib.a"

crlf
	stz crs_x
	inc crs_y
	rts
