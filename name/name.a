*=$1000
	jmp main 
!src <defs.h.a>
!src <bios.h.a>
!src <kernel.h.a>
!src <shell.h.a>


!address {
	.key 	= $10
	.txtbuf	= .buf	
}

main:
	stz .txtbuf

	+ShellPrintString text1
	

	ldx #$00
	
-	jsr keyin
	cmp #$0d ; return gedrueckt?
	beq +

	cmp #$08 ; backspace?
	beq .backspace

	cmp #$1f ; Ignore everything below "-"
    bcc -
	
	
	
	sta .txtbuf,x
	inx
	stz .txtbuf,x

--	jsr chrout

	cpx #$0f
	beq +
	
	bra -

.backspace
	dex
	bra --
+
	lda .txtbuf
	beq +
	cmp #'X'
	beq .end

	+ShellPrintString  text2
	+ShellPrintString  .txtbuf
	
	+ShellPrintString .crlf2
	bra main
+
	+ShellPrintString name
	
	+ShellPrintString .crlf
	bra main

.end
	jmp (retvec)



text1	!text "Wie heisst du? ", $00
text2	!text $0a,$0d,"Hallo, ", $00
name	!text "Bitte Namen eingeben.", $0a,$0d,$00
.crlf2	!text $0a,$0d
.crlf	!text $0a,$0d
.null	!text $00
.buf